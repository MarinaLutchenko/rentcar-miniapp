<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>RentCarNT</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>

*{ box-sizing:border-box; }

html, body{
  margin:0;
  padding:0;
  overflow-x:hidden;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0e0e0e;
  color:#fff;
}

.container{
  padding:20px;
  max-width:520px;
  margin:0 auto;
  height:100vh;
  overflow-y:auto;
}

h1{
  font-size:22px;
  margin:0 0 18px;
}

.subtitle{
  color:#8b8b8b;
  font-size:14px;
  margin-bottom:14px;
  line-height:1.35;
}

.card{
  background:#1c1c1c;
  padding:16px;
  border-radius:16px;
  margin-bottom:12px;
  cursor:pointer;
  transition:.15s;
  border:1px solid transparent;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
}
.card:hover{ border:1px solid #2ecc71; }
.card:active{ transform:scale(0.99); }

.btn{
  display:block;
  width:100%;
  padding:16px;
  border-radius:14px;
  font-size:16px;
  font-weight:700;
  margin-top:12px;
  text-align:center;
  cursor:pointer;
  border:none;
  text-decoration:none;
}

.btn.primary{
  background:#2ecc71;
  color:#0e0e0e !important;
}

.btn.secondary{
  background:#1c1c1c;
  color:#ffffff !important;
  border:1px solid #2b2b2b;
  font-weight:600;
}

input{
  width:100%;
  padding:14px;
  margin-bottom:12px;
  border-radius:12px;
  border:none;
  background:#1c1c1c;
  color:#fff;
  font-size:15px;
  outline:none;
}

.hidden{ display:none !important; }

.successWrap{
  width:100%;
  max-width:420px;
  margin:0 auto;
}

.success{
  background:#1c1c1c;
  padding:18px;
  border-radius:16px;
  text-align:center;
}

.success h2{
  margin:0 0 10px;
  font-size:22px;
}

.hint{
  margin-top:12px;
  color:#9a9a9a;
  font-size:13px;
}

.errorBox{
  margin-top:14px;
  background:#2b1515;
  border:1px solid #8a2e2e;
  color:#ffd9d9;
  padding:12px;
  border-radius:12px;
  font-size:13px;
  white-space:pre-wrap;
}

</style>
</head>

<body>
<div class="container">

<!-- –ì–û–†–û–î -->
<div id="screen-city">
<h1>–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ –∞—Ä–µ–Ω–¥—ã</h1>

<div class="card" onclick="selectCity('–ù—è—á–∞–Ω–≥')">üèù –ù—è—á–∞–Ω–≥</div>
<div class="card" onclick="selectCity('–ú—É–π–Ω–µ/–§–∞–Ω—Ç—å–µ—Ç')">üå¥ –ú—É–π–Ω–µ/–§–∞–Ω—Ç—å–µ—Ç</div>
<div class="card" onclick="selectCity('–§—É–∫—É–æ–∫')">üèñÔ∏è –§—É–∫—É–æ–∫</div>
<div class="card" onclick="selectCity('–î–∞–Ω–∞–Ω–≥')">üåÖ –î–∞–Ω–∞–Ω–≥</div>
<div class="card" onclick="selectCity('–•–æ—à–∏–º–∏–Ω')">üèô –•–æ—à–∏–º–∏–Ω</div>
<div class="card" onclick="selectCity('–•–∞–Ω–æ–π')">üèõ –•–∞–Ω–æ–π</div>

<div id="error-city" class="errorBox hidden"></div>
</div>

<!-- –°–ï–ì–ú–ï–ù–¢ -->
<div id="screen-segment" class="hidden">
<h1>–ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –∞–≤—Ç–æ –≤–∞–º –ø–æ–¥–æ–π–¥—ë—Ç?</h1>

<div class="card" onclick="selectSegment('–ë–∞–ª–∞–Ω—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞ –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç–∏')">üöó –ë–∞–ª–∞–Ω—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞ –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç–∏</div>
<div class="card" onclick="selectSegment('–ö–æ–º—Ñ–æ—Ä—Ç –¥–ª—è —Ç—Ä–∞—Å—Å—ã –∏ –≥–æ—Ä–Ω—ã—Ö –¥–æ—Ä–æ–≥')">üöô –ö–æ–º—Ñ–æ—Ä—Ç –¥–ª—è —Ç—Ä–∞—Å—Å—ã –∏ –≥–æ—Ä–Ω—ã—Ö –¥–æ—Ä–æ–≥</div>
<div class="card" onclick="selectSegment('–ü—Ä–æ—Å—Ç–æ—Ä –¥–ª—è —Å–µ–º—å–∏ –∏ –∫–æ–º–ø–∞–Ω–∏–∏')">üë®‚Äçüë©‚Äçüëß –ü—Ä–æ—Å—Ç–æ—Ä –¥–ª—è —Å–µ–º—å–∏ –∏ –∫–æ–º–ø–∞–Ω–∏–∏</div>
<div class="card" onclick="selectSegment('–≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è')">‚ö° –≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è</div>
<div class="card" onclick="selectSegment('–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∞—Å—Å')">üíé –ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∞—Å—Å</div>

<button class="btn secondary" onclick="backTo('screen-city')">‚Üê –ù–∞–∑–∞–¥</button>
<div id="error-segment" class="errorBox hidden"></div>
</div>

<!-- –ú–ê–®–ò–ù–´ -->
<div id="screen-car" class="hidden">
<h1>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å</h1>
<div class="subtitle">–ü–æ–∫–∞–∂–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞.</div>
<div id="car-list"></div>

<button class="btn secondary" onclick="backTo('screen-segment')">‚Üê –ù–∞–∑–∞–¥</button>
<div id="error-car" class="errorBox hidden"></div>
</div>

<!-- –î–ê–¢–´ -->
<div id="screen-dates" class="hidden">
<h1>–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—ã –∞—Ä–µ–Ω–¥—ã</h1>
<div class="subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã –ø–æ–µ–∑–¥–∫–∏.</div>

<input type="date" id="dateFrom" />
<input type="date" id="dateTo" />

<button class="btn primary" onclick="goToTrip()">–î–∞–ª–µ–µ</button>
<button class="btn secondary" onclick="backTo('screen-car')">‚Üê –ù–∞–∑–∞–¥</button>

<div id="error-dates" class="errorBox hidden"></div>
</div>
<!-- –≠–ö–†–ê–ù 5: –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï -->
<div id="screen-trip" class="hidden">
  <h1>–ö—É–¥–∞ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–æ–µ–∑–¥–∫–∞?</h1>
  <div class="subtitle">–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å.</div>

  <input type="text" id="tripDirection" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–∞–ª–∞—Ç, –ú—É–π–Ω–µ, –ø–æ –≥–æ—Ä–æ–¥—É, —Ç—Ä–∞—Å—Å–∞" />

  <button class="btn primary" onclick="goToContacts()">–î–∞–ª–µ–µ</button>
  <button class="btn secondary" onclick="backTo('screen-dates')">‚Üê –ù–∞–∑–∞–¥</button>

  <div id="error-trip" class="errorBox hidden"></div>
</div>
<!-- –ö–û–ù–¢–ê–ö–¢–´ -->
<div id="screen-contacts" class="hidden">
<h1>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h1>
<div class="subtitle">–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</div>

<input type="text" id="clientName" placeholder="–í–∞—à–µ –∏–º—è" />
<input type="text" id="clientContact" placeholder="Telegram –∏–ª–∏ WhatsApp" />

<button id="submitBtn" class="btn primary" onclick="sendBooking()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
<button class="btn secondary" onclick="backTo('screen-dates')">‚Üê –ù–∞–∑–∞–¥</button>

<div id="error-contacts" class="errorBox hidden"></div>
</div>

<!-- –£–°–ü–ï–• -->
<div id="screen-success" class="hidden">
<div class="successWrap">

<div class="success">
<h2>‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞</h2>
<p>–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</p>
<div class="hint">–ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å —Å—Ä–æ—á–Ω—ã–π ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –Ω–∞–ø—Ä—è–º—É—é.</div>
</div>

<a class="btn primary" href="https://t.me/RentCarNT" target="_blank">
‚úâÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É
</a>

<button class="btn secondary" onclick="resetFlow()">–û—Å—Ç–∞–≤–∏—Ç—å –µ—â—ë –∑–∞—è–≤–∫—É</button>

</div>
</div>

</div>

<script>

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw83bucvRMn2_TNmmLoDhnVSL5Eeh3nA01-ANetMaGh7sqET43VMiTcxVKt24mx_aU/exec";

let bookingData = {};
let isSubmitting = false;

const cars = {
"–ë–∞–ª–∞–Ω—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞ –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç–∏":[
{ name:"Hyundai Kona", price:40 },
{ name:"Mazda 2", price:35 },
{ name:"Mazda 3", price:40 },
{ name:"Honda City", price:35 }
],
"–ö–æ–º—Ñ–æ—Ä—Ç –¥–ª—è —Ç—Ä–∞—Å—Å—ã –∏ –≥–æ—Ä–Ω—ã—Ö –¥–æ—Ä–æ–≥":[
{ name:"Mazda CX-5", price:52 },
{ name:"Mazda CX-30", price:50 },
{ name:"Hyundai Creta", price:45 }
],
"–ü—Ä–æ—Å—Ç–æ—Ä –¥–ª—è —Å–µ–º—å–∏ –∏ –∫–æ–º–ø–∞–Ω–∏–∏":[
{ name:"Xpander (7 –º–µ—Å—Ç)", price:55 },
{ name:"Carens (7 –º–µ—Å—Ç)", price:65 }
],
"–≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è":[
{ name:"VinFast VF7", price:60 },
{ name:"VinFast VF5", price:45 }
],
"–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∞—Å—Å":[
{ name:"Mercedes C300", price:95 }
]
};

function show(id){
document.querySelectorAll('[id^="screen-"]').forEach(el=>el.classList.add('hidden'));
document.getElementById(id).classList.remove('hidden');
}

function backTo(id){ show(id); }

function setError(id,text){
const el=document.getElementById(id);
if(!text){ el.classList.add("hidden"); el.textContent=""; return; }
el.classList.remove("hidden");
el.textContent=text;
}

function selectCity(city){
bookingData={};
bookingData.city=city;
show("screen-segment");
}

function selectSegment(segment){
bookingData.segment=segment;
const list=document.getElementById("car-list");
list.innerHTML="";
(cars[segment]||[]).forEach(car=>{
const div=document.createElement("div");
div.className="card";
div.onclick=()=>selectCar(car.name,car.price);
div.innerHTML=`<strong>${car.name}</strong><br><span style="color:#2ecc71;">–æ—Ç $${car.price} / —Å—É—Ç–∫–∏</span>`;
list.appendChild(div);
});
show("screen-car");
}

function selectCar(name,price){
bookingData.car=name;
bookingData.price=price;
show("screen-dates");
}
function goToTrip(){
  const from = document.getElementById("dateFrom").value;
  const to   = document.getElementById("dateTo").value;

  if(!from || !to){
    setError("error-dates","–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–µ –¥–∞—Ç—ã.");
    return;
  }
  if(to < from){
    setError("error-dates","–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–Ω—å—à–µ –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞.");
    return;
  }

  bookingData.dateFrom = from;
  bookingData.dateTo = to;
  bookingData.dates = `${from} ‚Äî ${to}`;
  setError("error-dates","");

  show("screen-trip");   // ‚úÖ –≤–æ—Ç –∫–ª—é—á: –∏–¥—ë–º –Ω–∞ —ç–∫—Ä–∞–Ω –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
}
function goToContacts(){
  const trip = (document.getElementById("tripDirection").value || "").trim();

  if(!trip){
    setError("error-trip","–ù–∞–ø–∏—à–∏—Ç–µ, –∫—É–¥–∞ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–æ–µ–∑–¥–∫–∞.");
    return;
  }

  bookingData.tripDirection = trip;     // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  setError("error-trip","");

  show("screen-contacts");              // –∏–¥—ë–º –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ã
}

async function sendBooking(){
if(isSubmitting) return;
isSubmitting=true;

const btn=document.getElementById("submitBtn");
btn.disabled=true;
btn.style.opacity="0.6";
btn.textContent="–û—Ç–ø—Ä–∞–≤–∫–∞...";

if(document.activeElement) document.activeElement.blur();

const name=document.getElementById("clientName").value.trim();
const contact=document.getElementById("clientContact").value.trim();

if(!name||!contact){
setError("error-contacts","–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ –∫–æ–Ω—Ç–∞–∫—Ç.");
isSubmitting=false;
btn.disabled=false;
btn.style.opacity="1";
btn.textContent="–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É";
return;
}

bookingData.name=name;
bookingData.contact=contact;
bookingData.type="miniapp_booking";

try{
await fetch(SCRIPT_URL,{
method:"POST",
body:JSON.stringify(bookingData)
});
show("screen-success");
}catch(e){
setError("error-contacts","–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏.");
isSubmitting=false;
btn.disabled=false;
btn.style.opacity="1";
btn.textContent="–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É";
}
}

function resetFlow(){
bookingData={};
isSubmitting=false;
document.getElementById("dateFrom").value="";
document.getElementById("dateTo").value="";
document.getElementById("clientName").value="";
document.getElementById("clientContact").value="";
show("screen-city");
}

if(window.Telegram&&Telegram.WebApp){
const tg=Telegram.WebApp;
tg.expand();
function applyHeight(){
document.documentElement.style.height=tg.viewportStableHeight+"px";
document.body.style.height=tg.viewportStableHeight+"px";
}
applyHeight();
tg.onEvent("viewportChanged",applyHeight);
}

resetFlow();

</script>
</body>
</html>
